apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "honeybeepf.fullname" . }}
  labels:
    {{- include "honeybeepf.labels" . | nindent 4 }}
data:
  # OTLP Configuration for raw data transmission
  OTEL_EXPORTER_OTLP_ENDPOINT: {{ .Values.output.otlp.endpoint | quote }}
  OTEL_EXPORTER_OTLP_PROTOCOL: {{ .Values.output.otlp.protocol | quote }}

  # Built-in Probe Toggles (High-level)
  PROBE_BLOCK_IO: {{ .Values.builtinProbes.block_io.enabled | quote }}
  PROBE_NETWORK_LATENCY: {{ .Values.builtinProbes.network_latency.enabled | quote }}
  
  # Collection Interval (Resource Management Action Item)
  PROBE_INTERVAL: {{ .Values.builtinProbes.interval | quote }}

  # Custom Probe JSON: Serialized for the Aya/Rust agent
  {{- if or .Values.customProbes.kprobes .Values.customProbes.uprobes .Values.customProbes.tracepoints }}
  CUSTOM_PROBE_CONFIG: {{ toJson .Values.customProbes | quote }}
  {{- end }}